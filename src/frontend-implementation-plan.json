{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Remove local Offline mode and enforce always-online backend access behavior",
  "requirements": [
    {
      "id": "REQ-59",
      "summary": "Remove the local Online/Offline toggle and local-offline gating so the app always checks and calls the backend based only on backend-derived availability.",
      "acceptanceCriteria": [
        "The Title Screen no longer renders an Online/Offline switch or any text/alerts referring to 'Offline (Local)' or 'Local backend access only'.",
        "`frontend/src/state/useServerAccessStore.ts` is no longer used to gate backend calls or backend availability polling; backend availability polling on the Title Screen runs whenever the Title Screen is shown.",
        "Clicking New Game / Continue is no longer blocked by a local server-access-disabled condition; actions only depend on backend-derived availability/health (Checking/Online/Offline).",
        "The server status indicator no longer receives or uses an `isLocalOffline` state; it displays only backend-derived states: Checking, Online, Offline (all English).",
        "The Diagnostic Terminal `status` / `server status` commands no longer check or report a local offline mode; they attempt `actor.isAvailable()` and report Online/Offline results accordingly (all English)."
      ],
      "file_operations": [
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Remove all references to `useServerAccessStore` and any local-offline gating in launch flows. Ensure `useBackendAvailability` is enabled whenever the Title Screen is shown (no local toggle), and New Game/Continue only depend on backend-derived availability/health states."
        },
        {
          "path": "frontend/src/ui/TitleScreen.tsx",
          "operation": "modify",
          "description": "Remove the Online/Offline switch UI, any 'Offline (Local)' / 'Local backend access only' text and alerts, and eliminate any `isLocalOffline` state/logic. Keep the server status indicator and offline alert behavior based purely on `backendAvailability`. Uses shadcn-ui components already imported (e.g., Button/Card/Alert); verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/ui/ServerStatusIndicator.tsx",
          "operation": "modify",
          "description": "Remove the `isLocalOffline` prop and local-offline display path. Render only backend-derived states (Checking, Online, Offline) in English based on `backendAvailability`."
        },
        {
          "path": "frontend/src/ui/DiagnosticTerminalOverlay.tsx",
          "operation": "modify",
          "description": "Remove `useServerAccessStore` usage and stop passing any local server-access flag into terminal command execution. Keep the terminal admin gate behavior unchanged. Uses shadcn-ui components already imported (e.g., Button/Input/ScrollArea); verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/ui/terminal/commands.ts",
          "operation": "modify",
          "description": "Remove `serverAccessEnabled` from the terminal command context and delete the local-offline checks/messages for `status` and `server status`. Ensure these commands always attempt `checkServerStatus()` and report Online/Offline results in English."
        },
        {
          "path": "frontend/src/state/useServerAccessStore.ts",
          "operation": "delete",
          "description": "Delete the persisted local server-access store to fully remove the local offline mode feature and prevent future gating via this store."
        }
      ]
    },
    {
      "id": "REQ-60",
      "summary": "Update user-facing server availability/error/help text to reflect always-online behavior without claiming the app can start/restart a stopped canister.",
      "acceptanceCriteria": [
        "No user-facing text claims the app can force the backend canister to be 'always online' or can start/stop/restart the canister automatically.",
        "Any remaining server-offline messages continue to be in English and clearly indicate the backend can be offline due to canister stopped/out-of-cycles/network issues, and that the user may need to try again later."
      ],
      "file_operations": [
        {
          "path": "frontend/src/ui/TitleScreen.tsx",
          "operation": "modify",
          "description": "Revise the Server Unavailable messaging (and any other remaining server-related copy on the Title Screen) so it stays accurate about IC limitations (no in-app start/restart), mentions common causes (stopped canister, out of cycles, network), and remains English-only. Uses shadcn-ui components already imported (e.g., Alert/Button); verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Update any user-friendly summaries produced during New Game / Continue preflight failures so they reflect always-online behavior and do not mention local offline mode or imply the app can control canister uptime."
        },
        {
          "path": "frontend/src/utils/launchErrorNormalization.ts",
          "operation": "modify",
          "description": "Adjust normalized English error summaries (e.g., CANISTER_STOPPED / CONNECTIVITY) to explicitly avoid implying the app can restart the canister, and to mention plausible causes like stopped canister, out-of-cycles, or network issues with a 'try again later' recommendation."
        },
        {
          "path": "frontend/src/ui/terminal/commands.ts",
          "operation": "modify",
          "description": "Update terminal output strings for server checks to be English-only, always-online aligned, and accurate about limitations (no local offline mode references; no implication of canister start/restart)."
        },
        {
          "path": "frontend/src/ui/GameLaunchErrorScreen.tsx",
          "operation": "modify",
          "description": "Review and refine any user-visible fallback copy so it stays consistent with always-online behavior and does not claim or imply the app can start/stop/restart the canister (English only). Uses shadcn-ui components already imported (e.g., Card/Button); verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-61",
      "summary": "Update operations documentation to emphasize operational steps required to keep the canister running and funded with cycles, linking to deployment troubleshooting guidance.",
      "acceptanceCriteria": [
        "`frontend/OPS_CANISTER_AVAILABILITY.md` clearly states (in English) that uptime cannot be guaranteed in-app, and provides concise, actionable steps to keep the canister running and funded with cycles.",
        "The doc continues to reference `frontend/DEPLOYMENT_TROUBLESHOOTING.md` for deployment retry/failure diagnosis (English only)."
      ],
      "file_operations": [
        {
          "path": "frontend/OPS_CANISTER_AVAILABILITY.md",
          "operation": "modify",
          "description": "Expand/complete the operations guide in English with clear, actionable steps to keep the canister available (ensure running state, monitor and top up cycles, what to check when offline), explicitly stating the app cannot guarantee uptime or start/restart a stopped canister. Ensure it references `frontend/DEPLOYMENT_TROUBLESHOOTING.md` for deployment retry/failure diagnosis."
        }
      ]
    }
  ]
}